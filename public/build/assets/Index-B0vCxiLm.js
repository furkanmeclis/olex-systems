import{r as a,j as e,L as I}from"./app-DYHyNKN7.js";import{B as h}from"./button.esm-DU_nH01G.js";import{g as C,m as R}from"./index-CNywltEg.js";import{T as V}from"./toast.esm-U05f0Ars.js";import{C as D}from"./CarBody-C7T53D_W.js";import{O as z}from"./overlaypanel.esm-CgwkNoz4.js";import{m as o}from"./motion-LjQvIddk.js";import"./ripple.esm-BGxQRLkg.js";import"./index.esm-tnUHL2YI.js";import"./tooltip.esm-Csu0gaGK.js";import"./csstransition.esm-qnoiCi2y.js";import"./index.esm-CGiZOHsd.js";import"./index.esm-boBgQ27k.js";import"./index.esm-Qud_urY_.js";import"./index.esm-DsC-HLl0.js";import"./TransitionGroup-ZU2MhPGv.js";import"./index.esm-YmlpFJ13.js";import"./index.esm-B34zjyqu.js";import"./index.esm-BdEPyqFE.js";import"./index.esm-AFzQBoyj.js";import"./scrollpanel.esm-DX86Ah-C.js";import"./overlayservice.esm-D9C_91WQ.js";var F={VITE_APP_NAME:"OLEX Films®",VITE_APP_API_KEY:"AIzaSyDngyK-w3S7yGmtQa4EXWLaLfCJEqpUyVU",VITE_APP_AUTH_DOMAIN:"olex-6bc47.firebaseapp.com",VITE_APP_PROJECT_ID:"olex-6bc47",VITE_APP_STORAGE_BUCKET:"olex-6bc47.appspot.com",VITE_APP_MESSAGING_SENDER_ID:"852045853347",VITE_APP_APP_ID:"1:852045853347:web:ce59c95ea0d90bd10a4516",VITE_APP_MEASUREMENT_ID:"G-YSVP4EMESL",VITE_APP_VAPID_KEY:"BGU32plTKOAW6U4R5PhsBWEPr54Q34qNVfd7F9NAIoq7twYSo4GbkuyJvkNwKcR108nHz2HgF_Vqhud7HqPCgoI",BASE_URL:"/build/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const oe=({customerB:v,csrf_token:p,hash:x,services:N})=>{const[j,d]=a.useState(!1),f=a.useRef(null);a.useRef(null);const[c,y]=a.useState(v),l=a.useRef(null),[E,S]=a.useState(c.player_id!==null),{VITE_APP_VAPID_KEY:P}=F,[k,_]=a.useState(null),[u,w]=a.useState(null),[B,T]=a.useState(!1);a.useEffect(()=>{["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)&&T(!0),"serviceWorker"in navigator&&navigator.serviceWorker.register("/messaging-sw.js").then(function(i){console.log("Service Worker Kaydı Başarılı:",i),_(i)}).catch(function(i){console.log("Service Worker kaydı başarısız:",i)})},[]);const[r,m]=a.useState(Object.entries(JSON.parse(c.notification_settings)).map(([i,t])=>t?i:null).filter(i=>i!==null)),[O,b]=a.useState(!1);a.useEffect(()=>{let i=Object.entries(JSON.parse(c.notification_settings)).map(([t,s])=>s?t:null).filter(t=>t!==null);i.sort(),r.sort(),JSON.stringify(i)!==JSON.stringify(r)?b(!0):b(!1)},[r]);async function g(){const i=await Notification.requestPermission();if(i==="granted"){const t=await C(R,{vapidKey:P,serviceWorkerRegistration:k});d(!0);let s=new FormData;s.append("player_id",t),s.append("action","token"),fetch(route("customer.notifyUpdate",x),{method:"POST",headers:{"X-CSRF-TOKEN":p},body:s}).then(n=>n.json()).then(n=>{n.status?(l.current.show({severity:"success",summary:"Başarılı",detail:n.message,life:3e3}),S(!0),y(n.customer)):l.current.show({severity:"error",summary:"Hata",detail:n.message})}).catch(n=>{l.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{d(!1)})}else i==="denied"&&(l.current.show({severity:"error",summary:"Hata",detail:"Bildirimler Engellendi",life:3e3}),m(r.filter(t=>t!=="push")))}const A=()=>{["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)?"Notification"in window?(d(!0),g().then(i=>console.log())):l.current.show({severity:"info",summary:"Hata",detail:"Bildirimleri almak için tarayıcınızın URL bölümünde bulunan paylaş butonunu kullanarak uygulamamızı ana ekrana ekleyin. Bu sayede, uygulama yüklemeden hizmetlerinizi anında takip edebilirsiniz.",life:1e4}):(d(!0),g().then(i=>console.log()))};return e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gradient-to-br from-[#001100] to-[#002200]",children:[e.jsx(I,{title:"Müşteri Bilgileri"}),e.jsx(V,{ref:l}),e.jsx(z,{ref:f,showCloseIcon:!0,closeOnEscape:!0,children:e.jsx(D,{editable:!1,value:u==null?void 0:u.body,onChange:()=>{}})}),B&&e.jsx("div",{className:"max-w-4xl mx-auto px-4",children:e.jsx("div",{className:"bg-[#E6B800]/10 border border-[#E6B800] rounded-lg p-4 mt-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"pi pi-info-circle text-[#E6B800] text-xl mr-3"}),e.jsx("p",{className:"text-[#E6B800]",children:"Bildirimleri almak için tarayıcınızın paylaş butonunu kullanarak uygulamamızı ana ekrana ekleyin."})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex justify-center mb-12",children:e.jsx("img",{className:"h-16",src:"/uploads/olex-logo-yatay.svg",alt:"OLEX® Films"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"bg-[#001800]/50 backdrop-blur-sm p-6 rounded-xl border border-green-900/30",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"Müşteri Adı"}),e.jsx("div",{className:"text-white text-lg font-medium",children:c.name})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-[#001800]/50 backdrop-blur-sm p-6 rounded-xl border border-green-900/30",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"E-posta"}),e.jsx("div",{className:"text-white text-lg font-medium",children:c.email})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"bg-[#001800]/50 backdrop-blur-sm p-6 rounded-xl border border-green-900/30",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"Telefon"}),e.jsx("div",{className:"text-white text-lg font-medium",children:c.phone})]})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"bg-[#001800]/50 backdrop-blur-sm p-6 rounded-xl border border-green-900/30 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Bildirim Tercihleri"}),e.jsx("div",{className:"flex justify-center gap-3 mb-6",children:[{icon:"pi pi-envelope",value:"email",label:"E-posta"},{icon:"pi pi-phone",value:"sms",label:"SMS"},{icon:"pi pi-bell",value:"push",label:"Bildirim"}].map(i=>{const t=r&&r.includes(i.value);return e.jsxs("button",{onClick:()=>{m(t?r.filter(s=>s!==i.value):[...r,i.value])},className:`flex flex-col items-center px-4 py-2 rounded-lg transition-all duration-200 min-w-[80px] ${t?"bg-gradient-to-r from-[#004d00] to-[#E6B800] text-white shadow-lg":"bg-[#001100] hover:bg-[#002200] text-gray-400"}`,children:[e.jsx("i",{className:`${i.icon} text-lg mb-1`}),e.jsx("span",{className:"text-xs",children:i.label})]},i.value)})}),O&&e.jsx(h,{label:"Tercihleri Kaydet",icon:"pi pi-save",onClick:()=>{let i=new FormData;i.append("settings",JSON.stringify(r)),i.append("action","settings"),fetch(route("customer.notifyUpdate",x),{method:"POST",headers:{"X-CSRF-TOKEN":p},body:i}).then(t=>t.json()).then(t=>{t.status?(l.current.show({severity:"success",summary:"Başarılı",detail:t.message,life:3e3}),m(Object.entries(JSON.parse(t.customer.notification_settings)).map(([s,n])=>n?s:null).filter(s=>s!==null)),y(t.customer)):l.current.show({severity:"error",summary:"Hata",detail:t.message})}).catch(t=>{l.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})})},className:"w-full bg-gradient-to-r from-[#004d00] to-[#E6B800] hover:from-[#006600] hover:to-[#FFD700] text-white font-medium border-none"})]}),r&&r.includes("push")&&e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"bg-[#001800]/50 backdrop-blur-sm p-6 rounded-xl border border-green-900/30 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Tarayıcı Bildirimleri"}),e.jsx("div",{className:"text-center",children:E===!1?e.jsx(h,{label:"Bildirimleri Etkinleştir",loading:j,onClick:A,icon:"pi pi-bell",className:"bg-[#E6B800] hover:bg-[#FFD700] text-black font-medium border-none px-6 py-3"}):e.jsxs("div",{className:"text-[#E6B800] flex items-center justify-center gap-2",children:[e.jsx("i",{className:"pi pi-check-circle text-xl"}),e.jsx("span",{children:"Bildirimler Aktif"})]})})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},className:"bg-[#001800]/50 backdrop-blur-sm p-6 rounded-xl border border-green-900/30",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Hizmet Geçmişi"}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:N.map(i=>e.jsx("div",{className:"bg-[#001100]/80 p-4 rounded-lg border border-green-900/30 hover:border-[#E6B800]/30 transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-[#E6B800] font-medium mb-1",children:["Hizmet No: ",i.service_no]}),e.jsxs("div",{className:"text-gray-400",children:[i.car.brand," - ",i.car.model]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:t=>{w(i),f.current.toggle(t)},className:"p-2 rounded-lg bg-[#002200] hover:bg-[#003300] text-green-400 transition-all duration-200",children:e.jsx("i",{className:"pi pi-car text-lg"})}),e.jsx("button",{onClick:()=>{window.open(route("warranty.index",i.service_no),"_blank")},className:"p-2 rounded-lg bg-[#002200] hover:bg-[#003300] text-green-400 transition-all duration-200",children:e.jsx("i",{className:"pi pi-external-link text-lg"})})]})]})},i.id))})]})]})]})};export{oe as default};
