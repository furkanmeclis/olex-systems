import{r as o,j as e,c as v}from"./app-hKk0-_HF.js";import{I as p}from"./inputtext.esm-Dh25d2x9.js";import{D as B}from"./dropdown.esm-Brubv40p.js";import{B as w}from"./button.esm-CrZy9pBn.js";import{B as I}from"./blockui.esm-AKQi1FcZ.js";import{u as T}from"./formik.esm-XV2_PRlZ.js";import{c as O,a as d,b as D}from"./index.esm-Dz2tTiQT.js";import{M as G}from"./message.esm-CcQQTTIR.js";import{I as k}from"./inputswitch.esm-CvmM2NfY.js";import{P as F}from"./password.esm-BaQUzWWU.js";import"./ripple.esm-DNAZwi9o.js";import"./tooltip.esm-CRpoLIwW.js";import"./index.esm-BHq9II8q.js";import"./index.esm-DE1TD_cv.js";import"./index.esm-DXk8amZr.js";import"./overlayservice.esm-B2L4TZy7.js";import"./csstransition.esm-CbBJ3sVm.js";import"./index.esm-BvqJEmTn.js";import"./_baseClone-BgPU1wOP.js";import"./index.esm-DWULPhio.js";import"./index.esm-cwZO2zyh.js";import"./index.esm-BWdQp4e-.js";function de({csrf_token:S,toast:n,onHide:f,setUsers:z,setUpdateModalFooter:C,updateModal:_,roles:h,user:l}){const u=o.useRef(null),[c,x]=o.useState(!1),[r,b]=o.useState(!1),[g,M]=o.useState(h.find(s=>s.role===l.role)),j=o.useRef(),[P,A]=o.useState(!1),{values:i,handleSubmit:E,handleChange:m,setFieldValue:y,errors:N,setErrors:L}=T({initialValues:{name:l.name,email:l.email,phone:l.phone,image:l.avatar,active:!!l.active,reset_password:!1,password:"",password_confirmation:""},validationSchema:O().shape({name:d().required("Merkez Üyesi Adı Zorunludur."),email:d().email("Geçerli Bir E-Posta Adresi Giriniz.").required("E-Posta Adresi Zorunludur."),phone:d().required("Telefon Numarası Zorunludur."),password:d().min(6,"Şifre En Az 6 Karakter Olmalıdır.").equals([D("password_confirmation")],"Şifreler Eşleşmiyor.")}),onSubmit:s=>{x(!0);let a=new FormData;a.append("name",s.name),a.append("email",s.email),a.append("phone",s.phone),a.append("role",g.role),a.append("image",r),a.append("active",s.active),s.reset_password&&s.password!==""&&(a.append("reset_password",1),a.append("password",s.password),a.append("password_confirmation",s.password_confirmation)),a.append("_method","PUT"),fetch(route("super.central.update",l.id),{method:"POST",headers:{"X-CSRF-TOKEN":S},body:a}).then(t=>t.json()).then(t=>{t.status?(n.current.show({severity:"success",summary:"Başarılı",detail:t.message}),z(t.users),f()):n.current.show({severity:"error",summary:"Hata",detail:t.message})}).catch(t=>{n.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{x(!1)})}}),R=s=>{if(s.target.files.length===0)return b(!1),!1;const a=s.target.files[0];if(a.size>1024*1024*32)return n.current.show({severity:"error",summary:"Hata",detail:"Dosya Boyut 32MB'dan büyük olamaz."}),!1;if(!["image/jpeg","image/png","image/jpg"].includes(a.type))return n.current.show({severity:"error",summary:"Hata",detail:"Dosya Tipi Sadece JPG, JPEG, PNG olabilir."}),!1;b(a)};return o.useEffect(()=>{C(e.jsxs(e.Fragment,{children:[e.jsx(w,{label:"Vazgeç",icon:"pi pi-times",size:"small",link:!0,onClick:f,loading:c}),e.jsx(w,{label:"Kaydet",icon:"pi pi-save",size:"small",className:"p-button-success",loading:c,onClick:()=>{A(!0),j.current.click()}})]}))},[_]),e.jsx(I,{blocked:c,template:e.jsx("i",{className:"pi pi-spin pi-spinner",style:{fontSize:"3rem"}}),children:e.jsxs("form",{className:"p-fluid",onSubmit:E,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 mb-3",children:[e.jsx("div",{className:"col-span-2 grid gap-y-2",children:P&&Object.keys(N).length>0&&e.jsx(e.Fragment,{children:Object.entries(N).map(([s,a])=>e.jsx(G,{severity:"warn",text:a},s))})}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"name",className:"font-bold",children:["Merkez Üyesi Adı ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(p,{id:"name",name:"name",onChange:m,value:i.name,autoFocus:!0})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold",children:["Merkez Üyesi E-Posta Adresi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(p,{id:"email",type:"email",name:"email",onChange:m,value:i.email})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"phone",className:"font-bold",children:["Merkez Üyesi Telefon No ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(p,{id:"phone",type:"tel",name:"phone",onChange:m,value:i.phone})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold",children:["Merkez Üyesi Rolü ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(B,{value:g,onChange:s=>M(s.value),options:h,optionLabel:"label",className:"w-full"})]}),e.jsxs("div",{className:"mb-3 flex justify-start items-center gap-x-2",children:[e.jsx(k,{checked:i.active,inputId:"userActive",onChange:s=>y("active",s.value)}),e.jsxs("label",{htmlFor:"userActive",className:"font-bold",children:["Üye Aktifliği (",i.active?"Aktif":"Pasif",")"]})]}),e.jsxs("div",{className:"mb-3 flex justify-start items-center gap-x-2",children:[e.jsx(k,{checked:i.reset_password,inputId:"resetPassword",onChange:s=>y("reset_password",s.value)}),e.jsx("label",{htmlFor:"resetPassword",className:"font-bold",children:"Şifre Sıfırlama"})]}),i.reset_password&&e.jsxs("div",{className:"mb-3 grid grid-cols-2 gap-x-3",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",className:"font-bold",children:["Merkez Üyesi Şifre ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(F,{id:"password",name:"password",value:i.password,onChange:m,feedback:!1,toggleMask:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password_confirmation",className:"font-bold",children:["Merkez Üyesi Şifre Onayla",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(F,{id:"password_confirmation",name:"password_confirmation",value:i.password_confirmation,onChange:m,feedback:!1,toggleMask:!0})]})]}),e.jsx("label",{className:"font-bold ",htmlFor:"image",children:"Merkez Üyesi Avatar"}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 my-3",children:[e.jsxs("div",{className:"flex justify-center",children:[e.jsx("input",{id:"image",ref:u,type:"file",className:"hidden",accept:"image/*",onChange:R}),e.jsxs("div",{className:v("w-44 border-dashed border  h-44 cursor-pointer bg-gray-600/30 rounded-full flex justify-center items-center",{"border-orange-400":r===!1,"border-green-400":r!==!1}),onClick:()=>{u.current.click()},children:[r===!1&&e.jsx("i",{className:"pi pi-camera text-2xl text-orange-400"}),r!==!1&&e.jsx("i",{className:"pi pi-check text-2xl text-green-400"})]})]}),e.jsx("div",{children:e.jsx("img",{src:r!==!1?URL.createObjectURL(r):i.image,alt:r.name,className:v("w-full h-full max-h-44 bg-gray-300/10 border border-dashed object-contain rounded-lg",{"border-orange-400":r===!1,"border-green-400":r!==!1})})})]}),e.jsx("button",{type:"submit",style:{display:"none"},ref:j})]})})}export{de as default};
