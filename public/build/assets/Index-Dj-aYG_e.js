import{r as s,F as xe,j as e,S as he,A as fe,c as je}from"./app-Gu_WZQHt.js";import{A as ye}from"./AuthenticatedLayout-2S2_6ezI.js";import{D as ge}from"./datatable.esm-NaID0c80.js";import{C as m}from"./column.esm-DNbqWrSU.js";import{I as be}from"./inputtext.esm-xnWTAU7_.js";import{B as i}from"./button.esm-DVrsQp04.js";import{T as ve}from"./tooltip.esm-DqvN6xxZ.js";import{C as we,c as U}from"./confirmpopup.esm-lniL4FPz.js";import{T as ke}from"./toolbar.esm-BlLARMAE.js";import{D as k}from"./dialog.esm-CEFYt2vx.js";import{T as Ne}from"./toast.esm-C2SONjJv.js";import{O as Se}from"./overlaypanel.esm-Bb2jCqaY.js";import{C as Te}from"./checkbox.esm-Deob4cVx.js";import{A as Ce}from"./avatar.esm-DjERH5oT.js";import{u as ze}from"./ripple.esm-BmgBAEku.js";import Fe from"./Create-DPxWiwHl.js";import Be from"./Update-BVWhhqDW.js";import{B as Ae}from"./buttongroup.esm-BfWwEQHH.js";import"./ApplicationLogo-Bj5kQCv_.js";import"./Dropdown-oaL6QDOt.js";import"./transition-CRCurRsI.js";import"./tag.esm-EzTtgIVQ.js";import"./index.esm-ChVL6KfZ.js";import"./paginator.esm-Cxv8TYOQ.js";import"./inputnumber.esm-BzLWUBVP.js";import"./index.esm-CzUZpIU7.js";import"./dropdown.esm-R6RE6A8C.js";import"./index.esm-4ifppJy7.js";import"./index.esm-DravIrTS.js";import"./overlayservice.esm-Xpi3MvB6.js";import"./csstransition.esm-BhYveBEp.js";import"./index.esm-3bK0aKlJ.js";import"./index.esm-Ddg6hf65.js";import"./index.esm-B608UNsB.js";import"./index.esm-ByNrCyXS.js";import"./index.esm-CbgQxjZD.js";import"./index.esm-DBPgBsB6.js";import"./index.esm-B4h2qdeE.js";import"./formik.esm-CsTGf0Ki.js";import"./cloneDeep-DJN0yfLA.js";import"./index.esm-CIHLfhxH.js";import"./blockui.esm-meLmaJIP.js";import"./message.esm-mF2AdFvF.js";import"./inputswitch.esm-D_h16coN.js";import"./password.esm-B9Sd20es.js";import"./index.esm-Bskl3MPO.js";function Sa({auth:X,workersAll:$,csrf_token:u,dealer:J}){var L,O,P,_,H,M,R,Y,G,K,I,V;const o=s.useRef(null),g=s.useRef(null),[N,q]=s.useState({global:{value:null,matchMode:xe.CONTAINS}}),[b,f]=s.useState($),[S,Q]=s.useState([]),[De,T]=s.useState(!1),[C,Z]=s.useState(""),[p,j]=s.useState([]),[ee,ae]=s.useState({}),te=()=>{T(!0),fetch(route("central.dealers.listAll"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":u}}).then(a=>a.json()).then(a=>{Q(a.dealers)}).catch(a=>{console.log(a),o.current.show({severity:"error",summary:"Hata",detail:"Bayiler getirilirken bir hata oluştu."})}).finally(()=>{T(!1)})};s.useEffect(()=>{te()},[]);const z=["id","name","dealer_name","email","phone","avatar","active","updated_at","created_at","actions"],se={id:"ID",name:"Çalışan Adı",avatar:"Avatar Resmi",dealer_name:"Bayi Adı",active:"Üyelik Durumu",phone:"Telefon",role:"Rol",email:"Email",updated_at:"Güncellenme Tarihi",created_at:"Eklenme Tarihi",actions:"İşlemler"},[c,le]=ze(z,"super-workers-table-columns"),[F,v]=s.useState(!1),[B,w]=s.useState(!1),[ie,x]=s.useState(!1),[t,y]=s.useState({}),A=(a,d=!1)=>{const l=d?a:a.target.value;let n={...N};n.global.value=l,q(n),Z(l)},re=()=>e.jsx(e.Fragment,{children:e.jsx(ke,{start:()=>e.jsxs(e.Fragment,{children:[e.jsx(i,{icon:"pi pi-plus",size:"small",severity:"success",tooltip:"Yeni Çalışan Ekle",tooltipOptions:{position:"top"},onClick:()=>{v(!0)},className:"mr-2"}),e.jsx(i,{icon:"pi pi-bars",size:"small",severity:"info",tooltip:"Kolonları Yönet",tooltipOptions:{position:"top"},onClick:a=>{g.current.toggle(a)},className:"mr-2"}),p.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(i,{size:"small",icon:"pi pi-times",className:"p-button-warning mr-2",onClick:()=>j([]),tooltip:"Seçimi Temizle",tooltipOptions:{position:"top"}}),e.jsx(i,{size:"small",onClick:a=>{U({target:a.currentTarget,message:`Seçilen ${p.length} çalışanı silmek istediğinize emin misiniz?`,icon:"pi pi-info-circle",defaultFocus:"reject",acceptClassName:"p-button-danger",accept:()=>{let d=route("central.workers.multipleDestroy");fetch(d,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":u},body:JSON.stringify({workerIds:p.map(l=>l.id),dealerId:J.id})}).then(async l=>{let n=await l.json();l.status===404?o.current.show({severity:"error",summary:"Hata",detail:n.message}):l.status===500?o.current.show({severity:"warning",summary:"Hata",detail:n.message}):l.status===200&&(o.current.show({severity:"success",summary:"Başarılı",detail:n.message}),f(b.map(r=>p.map(h=>h.id).includes(r.id)?null:r).filter(Boolean)))}).catch(l=>{console.log(l),o.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{j([])})},acceptLabel:"Sil",rejectLabel:"Vazgeç"})},icon:"pi pi-trash",className:"p-button-danger",tooltip:`Seçilen ${p.length} çalışanı Sil`,tooltipOptions:{position:"top"}})]})]}),center:()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col items-center justify-center",children:p.length>0&&e.jsxs("span",{children:[p.length," çalışan seçildi."]})})}),end:()=>e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search"}),e.jsx(be,{size:"small",value:C,onChange:A,placeholder:"Çalışanlarda Arama Yapın"})]}),C!==""&&e.jsx(i,{size:"small",icon:"pi pi-times",className:"p-button-info ml-2",onClick:()=>A("",!0),tooltip:"Filtreyi Temizle",tooltipOptions:{position:"top"}})]})})}),ne=a=>e.jsx(i,{className:"flex justify-center",tooltip:a.active?"Aktif":"DeAktif",tooltipOptions:{position:"top",mouseTrack:!0},unstyled:!0,children:e.jsx("i",{className:je("pi ",{"true-icon pi-check-circle text-green-400":!!a.active,"false-icon pi-times-circle text-red-400":!a.active})})}),oe=re(),D=(a,d,l=()=>{})=>{const n=()=>{fetch(route("central.workers.destroy",d),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":u}}).then(async r=>{let h=await r.json();r.status===404?o.current.show({severity:"error",summary:"Hata",detail:h.message}):r.status===500?o.current.show({severity:"warning",summary:"Hata",detail:h.message}):r.status===200&&(l(),o.current.show({severity:"success",summary:"Başarılı",detail:h.message}),f(b.map(W=>W.id!==d?W:null).filter(Boolean)))}).catch(r=>{console.log(r),o.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{j(p.filter(r=>r.id!==d?r:null).filter(Boolean))})};U({target:a.currentTarget,message:"Bu işlemi gerçekleştirmek istediğinize emin misiniz?",icon:"pi pi-info-circle",defaultFocus:"reject",acceptClassName:"p-button-danger",accept:n,acceptLabel:"Sil",rejectLabel:"Vazgeç"})},[ce,de]=s.useState(e.jsx(e.Fragment,{})),[me,pe]=s.useState(e.jsx(e.Fragment,{})),E=a=>{ae(a),w(!0)},ue=a=>{y(a),x(!0)};return e.jsxs(ye,{user:X.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Çalışanlar"}),children:[e.jsx(he,{title:"Çalışanlar"}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs(e.Fragment,{children:[e.jsx(ve,{target:".custom-target-icon"}),e.jsx(we,{}),e.jsx(Ne,{ref:o}),e.jsx(Se,{ref:g,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h3",{children:"Kolonları Yönet"})}),e.jsxs("div",{className:"flex flex-col",children:[z.map((a,d)=>e.jsxs("div",{className:"flex my-1 items-center",children:[e.jsx(Te,{inputId:a,checked:c.includes(a),onChange:l=>{let n=[...c];l.checked?n.push(a):n=n.filter(r=>r!==a),le(n)}}),e.jsx("label",{htmlFor:a,className:"ml-2",children:se[a]})]},d)),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(i,{label:"Kaydet",severity:"success",size:"small",onClick:()=>{g.current.hide()}})})]})]})}),e.jsxs(ge,{dragSelection:!0,value:b,removableSort:!0,paginator:!0,paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",filters:N,loading:!1,selectionMode:null,selection:p,onSelectionChange:a=>j(a.value),globalFilterFields:["name","email","phone"],header:oe,emptyMessage:"Çalışan bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",children:[e.jsx(m,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),c.includes("id")&&e.jsx(m,{field:"id",sortable:!0,header:"#"}),c.includes("name")&&e.jsx(m,{field:"name",sortable:!0,header:"Çalışan Adı"}),c.includes("dealer_name")&&e.jsx(m,{field:"dealer.company.company_name",sortable:!0,header:"Bayi Adı",body:a=>e.jsx(i,{label:a.dealer.name,link:!0,size:"small",onClick:()=>{fe.visit(route("central.dealers.show",a.dealer.id))}})}),c.includes("email")&&e.jsx(m,{field:"email",sortable:!0,header:"Email"}),c.includes("phone")&&e.jsx(m,{field:"phone",sortable:!0,header:"Telefon No"}),c.includes("avatar")&&e.jsx(m,{field:"image",header:"Avatar",body:a=>e.jsx(Ce,{image:a.avatar,shape:"circle",size:"large"})}),c.includes("active")&&e.jsx(m,{field:"active",header:"Durumu",dataType:"boolean",body:ne}),c.includes("created_at")&&e.jsx(m,{field:"created_at",sortable:!0,header:"Eklenme Tarihi",body:a=>new Date(a.created_at).toLocaleString()}),c.includes("updated_at")&&e.jsx(m,{field:"updated_at",sortable:!0,header:"Güncellenme Tarihi",body:a=>new Date(a.updated_at).toLocaleString()}),c.includes("actions")&&e.jsx(m,{header:"İşlemler",body:a=>e.jsxs("div",{className:"flex justify-center gap-x-2",children:[e.jsx(i,{icon:"pi pi-eye",size:"small",tooltip:"Çalışanı Görüntüle",tooltipOptions:{position:"top"},severity:"info",onClick:()=>{ue(a)}}),e.jsx(i,{icon:"pi pi-pencil",size:"small",tooltip:"Çalışanı Düzenle",tooltipOptions:{position:"top"},severity:"warning",onClick:()=>{E(a)}}),e.jsx(i,{icon:"pi pi-times",tooltip:"Çalışanı Sil",tooltipOptions:{position:"top"},size:"small",onClick:d=>{D(d,a.id)},severity:"danger"})]})})]}),e.jsx(k,{header:"Yeni Çalışan Ekle",style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"},onHide:()=>v(!1),maximizable:!0,visible:F,footer:ce,children:e.jsx(Fe,{dealerId:1,dealers:S,onHide:()=>v(!1),csrf_token:u,toast:o,setWorkers:f,addModal:F,setAddModalFooter:de})}),e.jsx(k,{header:"Çalışanı Düzenle",style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"},onHide:()=>w(!1),maximizable:!0,visible:B,footer:me,children:e.jsx(Be,{updateModal:B,dealers:S,worker:ee,csrf_token:u,toast:o,onHide:()=>w(!1),setWorkers:f,setUpdateModalFooter:pe})}),e.jsx(k,{header:"Çalışanı Görüntüle",style:{width:"40vw"},breakpoints:{"960px":"75vw","641px":"100vw"},onHide:()=>x(!1),maximizable:!0,visible:ie,children:t&&e.jsx("div",{className:"flex flex-col gap-y-2",children:e.jsxs("div",{className:"flex flex-col gap-y-2",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h3",{className:"text-lg text-white font-semibold border-b pb-2",children:"Çalışan Bilgileri"})}),e.jsx("div",{className:"flex flex-col gap-y-2 mb-3",children:e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Çalışan Adı:"}),e.jsx("span",{children:t.name})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Email:"}),e.jsx("span",{children:t.email})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Telefon:"}),e.jsx("span",{children:t.phone})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Üyelik Durumu:"}),e.jsx("span",{children:t.active?"Aktif":"DeAktif"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Eklenme Tarihi:"}),e.jsx("span",{children:new Date(t.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Güncellenme Tarihi:"}),e.jsx("span",{children:new Date(t.updated_at).toLocaleString()})]})]})}),e.jsx("hr",{}),e.jsx("div",{className:"flex justify-between items-center mt-1",children:e.jsx("h3",{className:"text-lg text-white font-semibold border-b pb-2",children:"Bayi Bilgileri"})}),e.jsx("div",{className:"flex flex-col gap-y-2 mb-3",children:e.jsxs("div",{className:"flex flex-col gap-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Bayi Adı:"}),e.jsx("span",{children:(O=(L=t.dealer)==null?void 0:L.company)==null?void 0:O.company_name})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Bayi Email:"}),e.jsx("span",{children:(_=(P=t.dealer)==null?void 0:P.company)==null?void 0:_.company_email})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Bayi Telefon:"}),e.jsx("span",{children:(M=(H=t.dealer)==null?void 0:H.company)==null?void 0:M.company_phone})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Bayi Yönetici Adı:"}),e.jsx("span",{children:(R=t.dealer)==null?void 0:R.name})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Bayi Yönetici Email:"}),e.jsx("span",{children:(Y=t.dealer)==null?void 0:Y.email})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Bayi Yönetici Telefon:"}),e.jsx("span",{children:(G=t.dealer)==null?void 0:G.phone})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Bayi Yönetici Üyelik Durumu:"}),e.jsx("span",{children:(K=t.dealer)!=null&&K.active?"Aktif":"DeAktif"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Eklenme Tarihi:"}),e.jsx("span",{children:new Date((I=t==null?void 0:t.dealer)==null?void 0:I.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{children:"Güncellenme Tarihi:"}),e.jsx("span",{children:new Date((V=t==null?void 0:t.dealer)==null?void 0:V.updated_at).toLocaleString()})]})]})}),e.jsx("div",{className:"text-center mt-3",children:e.jsxs(Ae,{children:[e.jsx(i,{label:"Kapat",icon:"pi pi-times",severity:"info",size:"small",onClick:()=>{x(!1),y({})}}),e.jsx(i,{label:"Hizmet Kayıtları",icon:"pi pi-file",size:"small",severity:"help",onClick:()=>{}}),e.jsx(i,{label:"Düzenle",icon:"pi pi-pencil",size:"small",severity:"warning",onClick:a=>{x(!1),y({}),E(t)}}),e.jsx(i,{label:"Sil",icon:"pi pi-trash",size:"small",severity:"danger",onClick:a=>{D(a,t.id,()=>{x(!1),y({})})}})]})})]})})})]})})})})]})}export{Sa as default};
