import{r as n,j as e,c as w}from"./app-Baq8ApHb.js";import{I as p}from"./inputtext.esm-DNF8AOou.js";import{D as R}from"./dropdown.esm-CGY_epL-.js";import{B as F}from"./button.esm-DgT6WZGM.js";import{B as T}from"./blockui.esm-DF9E-dL0.js";import{u as O}from"./formik.esm-CxAZJmph.js";import{c as M,a as m,d as G}from"./index.esm-BjHMF_mu.js";import{M as L}from"./message.esm-9hL-0n4-.js";import{I as k}from"./inputswitch.esm-9mj-sH2g.js";import{P as S}from"./password.esm-BCZjHBmD.js";/* empty css            */import"./ripple.esm-Bvf-Pmh3.js";import"./tooltip.esm-BXBM_jrJ.js";import"./index.esm-jh-zEQr6.js";import"./index.esm-EdZmLmH6.js";import"./index.esm-DTMfxF1B.js";import"./overlayservice.esm-CHJbKesI.js";import"./csstransition.esm-Rb2Ld5o-.js";import"./index.esm-ByBSXWYu.js";import"./index.esm-DF7wB7Of.js";import"./cloneDeep-DJN0yfLA.js";import"./index.esm-BMbE-3LP.js";import"./index.esm-DgQDTGs2.js";import"./index.esm-D75JJD8k.js";function fe({csrf_token:_,toast:o,onHide:f,setWorkers:C,setUpdateModalFooter:P,updateModal:B,worker:t,dealers:h}){const u=n.useRef(null),[c,x]=n.useState(!1),[r,g]=n.useState(!1),j=Number(t.parent_id),[b,A]=n.useState(h.find(a=>a.id===j)),y=n.useRef(),[E,z]=n.useState(!1),{values:i,handleSubmit:I,handleChange:d,setFieldValue:N,errors:v,setErrors:U}=O({initialValues:{name:t.name,email:t.email,phone:t.phone,image:t.avatar,active:!!t.active,reset_password:!1,password:"",password_confirmation:""},validationSchema:M().shape({name:m().required("Çalışan Adı Zorunludur."),email:m().email("Geçerli Bir E-Posta Adresi Giriniz.").required("E-Posta Adresi Zorunludur."),phone:m().required("Telefon Numarası Zorunludur."),password:m().min(6,"Şifre En Az 6 Karakter Olmalıdır.").equals([G("password_confirmation")],"Şifreler Eşleşmiyor.")}),onSubmit:a=>{x(!0);let s=new FormData;s.append("name",a.name),s.append("email",a.email),s.append("dealer_id",j),s.append("phone",a.phone),s.append("image",r),s.append("active",a.active),s.append("hasPage",!0),a.reset_password&&a.password!==""&&(s.append("reset_password",1),s.append("password",a.password),s.append("password_confirmation",a.password_confirmation)),s.append("dealer_id",b.id),s.append("_method","PUT"),fetch(route("central.workers.update",t.id),{method:"POST",headers:{"X-CSRF-TOKEN":_},body:s}).then(l=>l.json()).then(l=>{l.status?(o.current.show({severity:"success",summary:"Başarılı",detail:l.message}),C(l.workers),f()):o.current.show({severity:"error",summary:"Hata",detail:l.message})}).catch(l=>{o.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{x(!1)})}}),D=a=>{if(a.target.files.length===0)return g(!1),!1;const s=a.target.files[0];if(s.size>1024*1024*32)return o.current.show({severity:"error",summary:"Hata",detail:"Dosya Boyut 32MB'dan büyük olamaz."}),!1;if(!["image/jpeg","image/png","image/jpg"].includes(s.type))return o.current.show({severity:"error",summary:"Hata",detail:"Dosya Tipi Sadece JPG, JPEG, PNG olabilir."}),!1;g(s)};return n.useEffect(()=>{P(e.jsxs(e.Fragment,{children:[e.jsx(F,{label:"Vazgeç",icon:"pi pi-times",size:"small",link:!0,onClick:f,loading:c}),e.jsx(F,{label:"Kaydet",icon:"pi pi-save",size:"small",className:"p-button-success",loading:c,onClick:()=>{z(!0),y.current.click()}})]}))},[B]),e.jsx(T,{blocked:c,template:e.jsx("i",{className:"pi pi-spin pi-spinner",style:{fontSize:"3rem"}}),children:e.jsxs("form",{className:"p-fluid",onSubmit:I,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 mb-3",children:[e.jsx("div",{className:"col-span-2 grid gap-y-2",children:E&&Object.keys(v).length>0&&e.jsx(e.Fragment,{children:Object.entries(v).map(([a,s])=>e.jsx(L,{severity:"warn",text:s},a))})}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"name",className:"font-bold",children:["Çalışan Adı ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(p,{id:"name",name:"name",onChange:d,value:i.name,autoFocus:!0})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold",children:["Çalışan E-Posta Adresi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(p,{id:"email",type:"email",name:"email",onChange:d,value:i.email})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"phone",className:"font-bold",children:["Çalışan Telefon No ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(p,{id:"phone",type:"tel",name:"phone",onChange:d,value:i.phone})]}),e.jsxs("div",{className:"mb-3 flex justify-start items-center gap-x-2",children:[e.jsx(k,{checked:i.active,inputId:"workerActive",onChange:a=>N("active",a.value)}),e.jsxs("label",{htmlFor:"workerActive",className:"font-bold",children:["Üye Aktifliği (",i.active?"Aktif":"Pasif",")"]})]}),e.jsxs("div",{className:"mb-3 flex justify-start items-center gap-x-2",children:[e.jsx(k,{checked:i.reset_password,inputId:"resetPassword",onChange:a=>N("reset_password",a.value)}),e.jsx("label",{htmlFor:"resetPassword",className:"font-bold",children:"Şifre Sıfırlama"})]}),i.reset_password&&e.jsxs("div",{className:"mb-3 grid grid-cols-2 gap-x-3",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",className:"font-bold",children:["Çalışan Şifre ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(S,{id:"password",name:"password",value:i.password,onChange:d,feedback:!1,toggleMask:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password_confirmation",className:"font-bold",children:["Çalışan Şifre Onayla",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(S,{id:"password_confirmation",name:"password_confirmation",value:i.password_confirmation,onChange:d,feedback:!1,toggleMask:!0})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"phone",className:"font-bold",children:["Bayi Seçiniz ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(R,{value:b,filter:!0,emptyFilterMessage:"Bayi Bulunamadı",filterBy:"name,email,phone",onChange:a=>A(a.value),options:h,optionLabel:"name",className:"w-full"})]}),e.jsx("label",{className:"font-bold ",htmlFor:"image",children:"Çalışan Avatar"}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 my-3",children:[e.jsxs("div",{className:"flex justify-center",children:[e.jsx("input",{id:"image",ref:u,type:"file",className:"hidden",accept:"image/*",onChange:D}),e.jsxs("div",{className:w("w-44 border-dashed border  h-44 cursor-pointer bg-gray-600/30 rounded-full flex justify-center items-center",{"border-orange-400":r===!1,"border-green-400":r!==!1}),onClick:()=>{u.current.click()},children:[r===!1&&e.jsx("i",{className:"pi pi-camera text-2xl text-orange-400"}),r!==!1&&e.jsx("i",{className:"pi pi-check text-2xl text-green-400"})]})]}),e.jsx("div",{children:e.jsx("img",{src:r!==!1?URL.createObjectURL(r):i.image,alt:r.name,className:w("w-full h-full max-h-44 bg-gray-300/10 border border-dashed object-contain rounded-lg",{"border-orange-400":r===!1,"border-green-400":r!==!1})})})]}),e.jsx("button",{type:"submit",style:{display:"none"},ref:y})]})})}export{fe as default};
