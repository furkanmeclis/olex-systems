import{r as c,j as r,c as b,y as x}from"./app-D2DnUuml.js";import{C as v}from"./chips.esm-Cw8TlV8q.js";import{B as n}from"./button.esm-BF7KQlEX.js";import{D as k}from"./datatable.esm-B-Syz3u1.js";import{C as l}from"./column.esm-BVQTRuxe.js";import{I as S}from"./inputtext.esm-DIqUNKS6.js";import{D as T}from"./divider.esm-s3Gi0Zqp.js";import{c as P}from"./confirmpopup.esm-H2Xo8cnm.js";import"./ripple.esm-CW5LnvHH.js";import"./index.esm-D3hHK-uQ.js";import"./tooltip.esm-DXOYtXMX.js";import"./index.esm-DEQ-M4Cw.js";import"./paginator.esm-DzaqkufV.js";import"./inputnumber.esm-BhjB4CmF.js";import"./index.esm-DLDPfOmM.js";import"./dropdown.esm-COdPd3FH.js";import"./index.esm-Dg-TVrBY.js";import"./index.esm-CR3igwbk.js";import"./overlayservice.esm-Cvp0Z3zA.js";import"./csstransition.esm-DeXPqE5a.js";import"./index.esm-i1Lh6PAN.js";import"./index.esm-YwDcR9r0.js";import"./index.esm-BHEgGL-6.js";import"./index.esm-Dpxvkpn6.js";const z=({csrf_token:d,product:u,productCodesModal:K,setFooter:N,onHide:w,toast:t})=>{const[g,m]=c.useState([]),[p,y]=c.useState([]),[h,a]=c.useState(!1),j=()=>{u&&(a(!0),fetch(route("super.products.listCodes",u.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":d}}).then(e=>e.json()).then(e=>{m(e.codes)}).catch(e=>{t.current.show({severity:"error",summary:"Hata",detail:"Ürün kodları getirilirken bir hata oluştu."})}).finally(()=>{a(!1)}))};c.useEffect(()=>{j()},[u]);const C=()=>{p.length>0?(a(!0),fetch(route("super.products.addCode",u.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":d},body:JSON.stringify({codes:p.join(",")})}).then(e=>e.json()).then(e=>{e.status?(y([]),t.current.show({severity:"success",summary:"Başarılı",detail:e.message}),m(e.codes)):t.current.show({severity:"error",summary:"Hata",detail:e.message})}).catch(e=>{t.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{a(!1)})):t.current.show({severity:"error",summary:"Hata",detail:"Ürün kodu eklemek için en az bir ürün kodu girmelisiniz."})};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-3",children:[r.jsx("label",{htmlFor:"description",className:"font-bold",children:"Ürün Kodları (Virgül ile ayırarak yazınız)"}),r.jsx(v,{value:p,className:"block",onChange:e=>y(e.value),separator:","})]}),r.jsx(n,{label:"Ürün Kodlarını Ekle",onClick:C,loading:h,className:"mb-3"}),r.jsx(T,{}),r.jsxs(k,{value:g,removableSort:!0,paginator:!0,emptyMessage:"Ürün kodu bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",filterDisplay:"row",filters:{code:{value:null,matchMode:"contains"},service_number:{value:null,matchMode:"contains"},"dealer.name":{value:null,matchMode:"contains"}},paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",loading:h,editMode:"row",onRowEditComplete:e=>{let{code:o,id:s,product_id:f}=e.newData;a(!0),e.data.code!==o?fetch(route("super.products.updateCode",f),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":d},body:JSON.stringify({code_id:s,code:o,_method:"put"})}).then(i=>i.json()).then(i=>{i.status?(t.current.show({severity:"success",summary:"Başarılı",detail:i.message}),m(i.codes)):t.current.show({severity:"error",summary:"Hata",detail:i.message})}).catch(i=>{t.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{a(!1)}):a(!1)},children:[r.jsx(l,{field:"code",sortable:!0,header:"Ürün Kodu",filter:!0,filterPlaceholder:"Koda Göre Filtreleyin",editor:e=>r.jsx(S,{type:"text",size:"small",value:e.value,onChange:o=>e.editorCallback(o.target.value)})}),r.jsx(l,{field:"used",sortable:!0,header:"Durumu",body:e=>r.jsx(n,{className:"flex justify-center",tooltip:e.used?"Kullanılmış":"Kullanılmamış",tooltipOptions:{position:"top"},unstyled:!0,children:r.jsx("i",{className:b("pi ",{"true-icon pi-check-circle text-green-400":!e.used,"false-icon pi-times-circle text-red-400":!!e.used})})})}),r.jsx(l,{header:"Konumu",filter:!0,field:"dealer.name",filterPlaceholder:"Konuma Göre Filtreleyin",body:e=>e.location!=="central"?r.jsx(n,{label:e.dealer.name,link:!0,size:"small",tooltip:"Bayiyi Görüntüle",onClick:()=>{x.visit(route("super.dealers.show",e.dealer.id))}}):"Merkez"}),r.jsx(l,{header:"Hizmet",field:"service_number",filter:!0,filterPlaceholder:"Hizmet Numarasına Göre Filtreleyin",body:e=>e.location!=="central"&&e.used?r.jsx(n,{label:e.service_number,link:!0,size:"small",tooltip:"Hizmeti Görüntüle",onClick:()=>{window.open(route("warranty.index",e.service_number),"_blank")}}):"Kullanılmamış"}),r.jsx(l,{field:"used_at",sortable:!0,header:"Kullanılma Tarihi",body:e=>e.used_at!==null?new Date(e.used_at).toLocaleString():"..."}),r.jsx(l,{field:"updated_at",sortable:!0,header:"Değişiklik Tarihi",body:e=>new Date(e.updated_at).toLocaleString()}),r.jsx(l,{header:"Düzenle",rowEditor:e=>!e.used}),r.jsx(l,{header:"Sil",body:e=>r.jsx(r.Fragment,{children:!e.used&&r.jsx(n,{icon:"pi pi-times",className:"ml-2",tooltip:"Ürün Kodunu Sil",tooltipOptions:{position:"top"},size:"small",onClick:o=>{P({target:o.currentTarget,message:"Ürün kodunu silmek istediğinize emin misiniz?",icon:"pi pi-info-circle",defaultFocus:"reject",acceptClassName:"p-button-danger",accept:()=>{a(!0),fetch(route("super.products.deleteCode",e.id),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":d}}).then(s=>s.json()).then(s=>{s.status?(t.current.show({severity:"success",summary:"Başarılı",detail:s.message}),m(f=>f.filter(i=>i.id!==e.id))):t.current.show({severity:"error",summary:"Hata",detail:s.message})}).catch(s=>{t.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{a(!1)})},acceptLabel:"Sil",rejectLabel:"Vazgeç"})},severity:"danger"})})})]})]})},re=z;export{re as default};
