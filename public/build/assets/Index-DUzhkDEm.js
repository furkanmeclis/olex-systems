import{r as n,j as e,S as G}from"./app-D0mPTlLT.js";import{A as R}from"./AuthenticatedLayout-B3vaHEvR.js";import{T as F}from"./toast.esm-DCADLpGo.js";import{I as v}from"./inputtextarea.esm-DJzaBMoy.js";import{A as O,a as C}from"./accordion.esm-6AQfaJIK.js";import{C as H}from"./checkbox.esm-m2_gUQw1.js";import{B as k}from"./button.esm-NYPGq0YV.js";import{C as I,c as w}from"./confirmpopup.esm-DiMHqE5y.js";import{I as N}from"./inputtext.esm-BfiG1az1.js";import"./Dropdown-Cha3nIER.js";import"./tag.esm-Dsl9iJ1L.js";import"./ripple.esm-Dp2KI1ix.js";import"./motion-Cy9_qeAM.js";import"./csstransition.esm-DL5I2jB8.js";import"./index.esm-DZqha3X7.js";import"./index.esm-UdRK3S8I.js";import"./index.esm-DGB2Ro_U.js";import"./index.esm-D1lWgiY_.js";import"./TransitionGroup-B5Qww4eO.js";import"./tooltip.esm-BL5Tc1BM.js";import"./index.esm-3kKdjh-j.js";import"./index.esm-FRiiXSZe.js";import"./index.esm-CGywSAff.js";import"./overlayservice.esm-DhOLZI92.js";const L="ŞşÇçĞğİı",A=m=>{let s=m.length,a=0,o=!1;for(let c of m)L.includes(c)&&(o=!0,s++);return s+=5,o?s<=155?a=1:s<=293?a=2:s<=440?a=3:s<=587?a=4:s<=735?a=5:a=Math.ceil((s-735)/147)+5:s<=160?a=1:s<=306?a=2:s<=459?a=3:s<=612?a=4:s<=765?a=5:a=Math.ceil((s-765)/153)+5,{charCount:s,smsCount:a}},E=(m="")=>{const[s,a]=n.useState(m),[o,c]=n.useState(0),[p,f]=n.useState(1);return n.useEffect(()=>{const u=A(s);c(u.charCount),f(u.smsCount)},[s]),{message:s,setMessage:a,charCount:o,smsCount:p}};function ce({auth:m,csrf_token:s}){const a=[{name:"Sistem Yöneticileri",key:"super"},{name:"Merkez Çalışanları",key:"central"},{name:"Bayiler",key:"dealer"},{name:"Bayi Çalışanları",key:"worker"},{name:"Müşteriler",key:"customer"}],{message:o,setMessage:c,smsCount:p,charCount:f}=E(),[u,B]=n.useState(a),[h,j]=n.useState(""),[x,g]=n.useState(""),[y,S]=n.useState("https://www.instagram.com/olexfilms"),z=t=>{let i=[...u];t.checked?i.push(t.value):i=i.filter(r=>r.key!==t.value.key),B(i)},l=n.useRef(null),[b,d]=n.useState(!1),M=t=>{if(o.length===0){l.current.show({severity:"warn",summary:"Hata",detail:"Mesaj Boş Olamaz",life:3e3});return}w({target:t.currentTarget,message:"SMS Gönderilecek. Onaylıyor musunuz?",icon:"pi pi-info-circle",acceptClassName:"p-button-success",acceptLabel:"Gönder",rejectLabel:"İptal",accept:()=>{d(!0);let i=new FormData;i.append("message",o),i.append("target",u.map(r=>r.key).join(",")),fetch(route("super.notifySms.sendSMS"),{method:"POST",headers:{"X-CSRF-TOKEN":s},body:i}).then(r=>r.json()).then(r=>{r.status?(l.current.show({severity:"success",summary:"Başarılı",detail:r.message}),c("")):l.current.show({severity:"error",summary:"Hata",detail:r.message})}).finally(()=>{d(!1)})}})},T=t=>{if(h===""){l.current.show({severity:"warn",summary:"Hata",detail:"Başlık Boş Olamaz",life:3e3});return}if(x===""){l.current.show({severity:"warn",summary:"Hata",detail:"İçerik Boş Olamaz",life:3e3});return}if(y===""){l.current.show({severity:"warn",summary:"Hata",detail:"Url Boş Olamaz",life:3e3});return}w({target:t.currentTarget,message:"Bu Bildirim Gönderimi İçin Onaylıyor Musunuz?",icon:"pi pi-info-circle",acceptLabel:"Gönder",acceptIcon:"pi pi-bell",rejectIcon:"pi pi-times",rejectLabel:"Vazgeç",defaultFocus:"accept",accept:()=>{d(!0);let i=new FormData;i.append("title",h),i.append("content",x),i.append("url",y),fetch(route("super.notifySms.sendNotification"),{method:"POST",headers:{"X-CSRF-TOKEN":s},body:i}).then(r=>r.json()).then(r=>{r.status?(l.current.show({severity:"success",summary:"Başarılı",detail:r.message,life:3e3}),j(""),g(""),S("https://www.instagram.com/olexfilms")):l.current.show({severity:"error",summary:"Hata",detail:r.message,life:3e3})}).catch(r=>{l.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{d(!1)})}})};return e.jsxs(R,{user:m.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Bildirim & SMS"}),children:[e.jsx(G,{title:"Bildirim & SMS"}),e.jsx(I,{}),e.jsx(F,{ref:l}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs(O,{className:"p-0",activeIndex:0,children:[e.jsxs(C,{header:"Sms Gönderimi",children:[e.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[e.jsxs("label",{htmlFor:"username",className:"font-semibold",children:["Sms İçeriği [",f," Karakter / ",p," SMS]"]}),e.jsx(v,{id:"username",value:o,onChange:t=>c(t.target.value),"aria-describedby":"username-help"})]}),e.jsx("p",{className:"font-semibold mb-3",children:"Gönderim Hedefi"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3",children:a.map(t=>e.jsxs("div",{className:"flex align-items-center",children:[e.jsx(H,{inputId:t.key,name:"category",value:t,onChange:z,checked:u.some(i=>i.key===t.key)}),e.jsx("label",{htmlFor:t.key,className:"ml-2",children:t.name})]},t.key))}),e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(k,{label:"Gönder",size:"small",onClick:M,loading:b,icon:"pi pi-send"})})]}),e.jsxs(C,{header:"Bildirim Gönder",children:[e.jsxs("div",{className:"p-fluid",children:[e.jsxs("div",{className:"p-field mb-3",children:[e.jsx("label",{htmlFor:"title",className:"font-semibold",children:"Başlık"}),e.jsx(N,{id:"title",value:h,onChange:t=>j(t.target.value),placeholder:"Başlık Giriniz"})]}),e.jsxs("div",{className:"p-field mb-3",children:[e.jsx("label",{htmlFor:"content",className:"font-semibold",children:"İçerik"}),e.jsx(v,{id:"content",value:x,onChange:t=>g(t.target.value),rows:3,cols:20,autoResize:!0,placeholder:"Bildirim İçeriğini Giriniz"})]}),e.jsxs("div",{className:"p-field mb-3",children:[e.jsx("label",{htmlFor:"url",className:"font-semibold",children:"Url"}),e.jsx(N,{id:"url",value:y,onChange:t=>S(t.target.value),placeholder:"Bir URL Giriniz"}),e.jsx("small",{children:"(Gireceğiniz URL'e Yönlendirilir.)"})]})]}),e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(k,{label:"Gönder",size:"small",onClick:T,loading:b,icon:"pi pi-bell"})})]})]})})})]})}export{ce as default};
