import{r as c,j as e}from"./app-Baq8ApHb.js";import{I as r}from"./inputtext.esm-DNF8AOou.js";import{B as f}from"./button.esm-DgT6WZGM.js";import{B as _}from"./blockui.esm-DF9E-dL0.js";import{u as C}from"./formik.esm-CxAZJmph.js";import{c as T,a as p}from"./index.esm-BjHMF_mu.js";import{M as k}from"./message.esm-9hL-0n4-.js";import{S as B,B as M}from"./badge.esm-D102A8on.js";import{T as w}from"./toast.esm-BuJ7Yd3m.js";import{D as z}from"./dialog.esm-BzlEms0M.js";/* empty css            */import"./ripple.esm-Bvf-Pmh3.js";import"./tooltip.esm-BXBM_jrJ.js";import"./index.esm-EdZmLmH6.js";import"./cloneDeep-DJN0yfLA.js";import"./index.esm-DF7wB7Of.js";import"./index.esm-BMbE-3LP.js";import"./index.esm-DgQDTGs2.js";import"./csstransition.esm-Rb2Ld5o-.js";import"./index.esm-DTMfxF1B.js";function ae({csrf_token:j,setUsers:b,user:i,visible:g,setVisible:o}){const h=c.useRef(null),[m,u]=c.useState(!1),v=c.useMemo(()=>i!=null&&i.notification_settings?Object.entries(JSON.parse(i.notification_settings)).map(([a,s])=>s?a:null).filter(a=>a!==null):[],[i]),d=(a,s,t)=>{h.current.show({severity:a,summary:s,detail:t})},{values:l,handleSubmit:N,submitForm:y,submitCount:S,handleChange:n,dirty:O,setFieldValue:F,errors:x,setErrors:A}=C({initialValues:{name:i.name,email:i.email,phone:i.phone,image:i.avatar,gender:i.gender,player_id:i.player_id,address:i.address,contact:v},validationSchema:T().shape({name:p().required("Müşteri Adı Zorunludur."),email:p().email("Geçerli Bir E-Posta Adresi Giriniz.").required("E-Posta Adresi Zorunludur."),phone:p().required("Telefon Numarası Zorunludur.")}),onSubmit:a=>{u(!0);let s=new FormData;s.append("name",a.name),s.append("email",a.email),s.append("phone",a.phone),s.append("notification_settings",JSON.stringify(a.contact)),s.append("address",a.address),s.append("player_id",a.player_id),s.append("_method","PUT"),fetch(route("worker.customers.update",i.id),{method:"POST",headers:{"X-CSRF-TOKEN":j},body:s}).then(t=>t.json()).then(t=>{t.status?(d("success","Başarılı",t.message),setTimeout(()=>{b(t.customers),o(!1)},500)):d("error","Hata",t.message)}).catch(t=>{console.log(t),d("error","Hata","Bir Hata Oluştu")}).finally(()=>{u(!1)})}});return e.jsxs(e.Fragment,{children:[e.jsx(w,{ref:h}),e.jsx(z,{header:"Müşteriyi Düzenle",style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"},onHide:()=>o(!1),maximizable:!0,visible:g,footer:e.jsxs(e.Fragment,{children:[e.jsx(f,{label:"Vazgeç",icon:"pi pi-times",size:"small",link:!0,onClick:()=>o(!1),loading:m}),e.jsx(f,{label:"Kaydet",icon:"pi pi-save",size:"small",className:"p-button-success",loading:m,onClick:()=>{y().then(a=>{})}})]}),children:e.jsx(_,{blocked:m,template:e.jsx("i",{className:"pi pi-spin pi-spinner",style:{fontSize:"3rem"}}),children:e.jsxs("form",{className:"p-fluid",onSubmit:N,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 mb-3",children:[e.jsx("div",{className:"col-span-2 grid gap-y-2",children:S>0&&Object.keys(x).length>0&&e.jsx(e.Fragment,{children:Object.entries(x).map(([a,s])=>e.jsx(k,{severity:"warn",text:s},a))})}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"name",className:"font-bold",children:["Müşteri Adı ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(r,{id:"name",name:"name",onChange:n,value:l.name||"",autoFocus:!0})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold",children:["Müşteri E-Posta Adresi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(r,{id:"email",type:"email",name:"email",onChange:n,value:l.email||""})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"phone",className:"font-bold",children:["Müşteri Telefon No ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(r,{id:"phone",type:"tel",name:"phone",onChange:n,value:l.phone||""})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"address",className:"font-bold",children:["Müşteri Adresi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(r,{id:"address",type:"text",name:"address",onChange:n,value:l.address||""})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"player_id",className:"font-bold",children:"Müşteri Device Id"}),e.jsx(r,{id:"player_id",type:"text",name:"player_id",onChange:n,value:l.player_id||""})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"address",className:"font-bold",children:"İletişim Tercihleri"}),e.jsx(B,{multiple:!0,value:l.contact,onChange:a=>F("contact",a.value),itemTemplate:a=>{let s=l.contact&&l.contact.includes(a.value);return e.jsx("div",{className:"w-full text-center",children:e.jsx("i",{className:a.icon+" p-overlay-badge",style:{fontSize:"1.5rem"},children:s&&e.jsx(M,{severity:"success",value:e.jsx("i",{className:"pi pi-check"}),style:{fontSize:"1px"}})})})},optionLabel:"value",options:[{icon:"pi pi-envelope",value:"email"},{icon:"pi pi-send",value:"sms"},{icon:"pi pi-bell",value:"push"}]})]})]})})})]})}export{ae as default};
