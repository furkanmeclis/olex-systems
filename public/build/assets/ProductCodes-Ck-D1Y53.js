import{r as m,j as t,c as x,A as b}from"./app-Co-7gdmf.js";import{C as k}from"./chips.esm-B84xmHHd.js";import{B as c}from"./button.esm-D0cqDLEO.js";import{D as S}from"./datatable.esm-Ck35Ejae.js";import{C as o}from"./column.esm-Bbb13DMG.js";import{I as v}from"./inputtext.esm-nTCFpGx1.js";import{D as T}from"./divider.esm-A596cqwX.js";import{c as N}from"./confirmpopup.esm-CfQug19V.js";import"./ripple.esm-7O1p7hxI.js";import"./index.esm-r-Bh0G5C.js";import"./tooltip.esm-Bn9xShzq.js";import"./index.esm-DuTvK6M2.js";import"./paginator.esm-CYSZjHRC.js";import"./inputnumber.esm-Chne10LU.js";import"./index.esm-B8v_r4y0.js";import"./dropdown.esm-BhSix268.js";import"./index.esm-wXcS5RWu.js";import"./index.esm-jHyHxFnZ.js";import"./overlayservice.esm-DWAzjbnB.js";import"./csstransition.esm-KBhN1N5D.js";import"./index.esm-CGMUC-m6.js";import"./index.esm-Cehgv9IL.js";import"./index.esm-BsIyfWm9.js";import"./index.esm-C6E0P9gq.js";const ee=({csrf_token:n,product:d,productCodesModal:P,setFooter:w,onHide:z,toast:r})=>{const[g,u]=m.useState([]),[p,y]=m.useState([]),[f,a]=m.useState(!1),j=()=>{d&&(a(!0),fetch(route("super.products.listCodes",d.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n}}).then(e=>e.json()).then(e=>{u(e.codes)}).catch(e=>{r.current.show({severity:"error",summary:"Hata",detail:"Ürün kodları getirilirken bir hata oluştu."})}).finally(()=>{a(!1)}))};m.useEffect(()=>{j()},[d]);const C=()=>{p.length>0?(a(!0),fetch(route("super.products.addCode",d.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({codes:p.join(",")})}).then(e=>e.json()).then(e=>{e.status?(y([]),r.current.show({severity:"success",summary:"Başarılı",detail:e.message}),u(e.codes)):r.current.show({severity:"error",summary:"Hata",detail:e.message})}).catch(e=>{r.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{a(!1)})):r.current.show({severity:"error",summary:"Hata",detail:"Ürün kodu eklemek için en az bir ürün kodu girmelisiniz."})};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{htmlFor:"description",className:"font-bold",children:"Ürün Kodları (Virgül ile ayırarak yazınız)"}),t.jsx(k,{value:p,className:"block",onChange:e=>y(e.value),separator:","})]}),t.jsx(c,{label:"Ürün Kodlarını Ekle",onClick:C,loading:f,className:"mb-3"}),t.jsx(T,{}),t.jsxs(S,{value:g,removableSort:!0,paginator:!0,emptyMessage:"Ürün kodu bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",loading:f,editMode:"row",onRowEditComplete:e=>{let{code:l,id:i,product_id:h}=e.newData;a(!0),e.data.code!==l?fetch(route("super.products.updateCode",h),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({code_id:i,code:l,_method:"put"})}).then(s=>s.json()).then(s=>{s.status?(r.current.show({severity:"success",summary:"Başarılı",detail:s.message}),u(s.codes)):r.current.show({severity:"error",summary:"Hata",detail:s.message})}).catch(s=>{r.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{a(!1)}):a(!1)},children:[t.jsx(o,{field:"code",sortable:!0,header:"Ürün Kodu",editor:e=>t.jsx(v,{type:"text",size:"small",value:e.value,onChange:l=>e.editorCallback(l.target.value)})}),t.jsx(o,{field:"used",sortable:!0,header:"Durumu",body:e=>t.jsx(c,{className:"flex justify-center",tooltip:e.used?"Kullanılmış":"Kullanılmamış",tooltipOptions:{position:"top"},unstyled:!0,children:t.jsx("i",{className:x("pi ",{"true-icon pi-check-circle text-green-400":!e.used,"false-icon pi-times-circle text-red-400":!!e.used})})})}),t.jsx(o,{sortable:!0,header:"Konumu",body:e=>e.location!=="central"?t.jsx(c,{label:e.dealer.name,link:!0,size:"small",tooltip:"Bayiyi Görüntüle",onClick:()=>{b.visit(route("super.dealers.show",e.dealer.id))}}):"Merkez"}),t.jsx(o,{field:"used_at",sortable:!0,header:"Kullanılma Tarihi",body:e=>e.used_at!==null?new Date(e.used_at).toLocaleString():"..."}),t.jsx(o,{field:"updated_at",sortable:!0,header:"Değişiklik Tarihi",body:e=>new Date(e.updated_at).toLocaleString()}),t.jsx(o,{header:"Düzenle",rowEditor:e=>!e.used}),t.jsx(o,{header:"Sil",body:e=>t.jsx(t.Fragment,{children:!e.used&&t.jsx(c,{icon:"pi pi-times",className:"ml-2",tooltip:"Ürün Kodunu Sil",tooltipOptions:{position:"top"},size:"small",onClick:l=>{N({target:l.currentTarget,message:"Ürün kodunu silmek istediğinize emin misiniz?",icon:"pi pi-info-circle",defaultFocus:"reject",acceptClassName:"p-button-danger",accept:()=>{a(!0),fetch(route("super.products.deleteCode",e.id),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n}}).then(i=>i.json()).then(i=>{i.status?(r.current.show({severity:"success",summary:"Başarılı",detail:i.message}),u(h=>h.filter(s=>s.id!==e.id))):r.current.show({severity:"error",summary:"Hata",detail:i.message})}).catch(i=>{r.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{a(!1)})},acceptLabel:"Sil",rejectLabel:"Vazgeç"})},severity:"danger"})})})]})]})};export{ee as default};
