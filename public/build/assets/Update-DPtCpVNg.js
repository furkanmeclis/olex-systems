import{j as e}from"./app-avhlPhiM.js";import{I as o}from"./inputtext.esm-CXUGpXfk.js";import{B as F}from"./blockui.esm-Ch7Pd_XS.js";import{u as O}from"./formik.esm-CMRrPpgq.js";import{c as S,a as l}from"./index.esm-DgGXe70E.js";import{M as C}from"./message.esm-Dif1JDD1.js";import{S as h}from"./selectbutton.esm-1BzEw1K4.js";import{B as z}from"./badge.esm-DTzHPvIP.js";import{I as T}from"./inputmask.esm-gXtrQ0Ir.js";import{m as f}from"./motion-DSpvOdeD.js";import"./ripple.esm-BqSoC-Lb.js";import"./tooltip.esm-DhBWKiHa.js";import"./_baseClone-BgPU1wOP.js";import"./index.esm-Cg0PB3KT.js";import"./index.esm-BpBvkme2.js";import"./index.esm-x39jFGr-.js";function G({csrf_token:v,toast:c,onHide:x,setUsers:b,formRef:N,formSubmitted:j,loading:y,setLoading:d,user:i}){const{values:s,handleSubmit:g,handleChange:m,dirty:_,setFieldValue:p,errors:r,setErrors:k}=O({initialValues:{type:i.type||"individual",name:i.name,email:i.email,phone:i.phone,image:i.avatar,gender:i.gender,player_id:i.player_id,address:i.address,contact:Object.entries(JSON.parse(i.notification_settings)).map(([a,n])=>n?a:null).filter(a=>a!==null),vatName:i.vat_name||"",vatNumber:i.vat_number||"",vatOffice:i.vat_office||""},validationSchema:S().shape({type:l().required("Müşteri tipi seçimi zorunludur"),name:l().required("Müşteri/Firma Adı zorunludur"),email:l().email("Geçerli bir e-posta adresi giriniz").required("E-posta adresi zorunludur"),phone:l().required("Telefon numarası zorunludur"),address:l().required("Adres zorunludur"),vatName:l().when("type",{is:"company",then:()=>l().required("Vergi adı zorunludur"),otherwise:()=>l()}),vatNumber:l().when("type",{is:"company",then:()=>l().required("Vergi numarası zorunludur"),otherwise:()=>l()}),vatOffice:l().when("type",{is:"company",then:()=>l().required("Vergi dairesi zorunludur"),otherwise:()=>l()})}),onSubmit:a=>{d(!0);let n=new FormData;Object.keys(a).forEach(t=>{t==="contact"?n.append("notification_settings",JSON.stringify(a[t])):n.append(t,a[t])}),n.append("_method","PUT"),fetch(route("central.customers.update",i.id),{method:"POST",headers:{"X-CSRF-TOKEN":v},body:n}).then(t=>t.json()).then(t=>{t.status?(c.current.show({severity:"success",summary:"Başarılı",detail:t.message}),b(t.customers),x()):c.current.show({severity:"error",summary:"Hata",detail:t.message})}).catch(()=>{c.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{d(!1)})}}),u=useMemo(()=>s.type==="company",[s.type]),w=[{icon:"pi pi-user",value:"individual",label:"Bireysel"},{icon:"pi pi-building",value:"company",label:"Kurumsal"}];return e.jsx(F,{blocked:y,template:e.jsx("i",{className:"pi pi-spin pi-spinner",style:{fontSize:"3rem"}}),children:e.jsxs("form",{className:"p-fluid",onSubmit:g,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-x-3 mb-3",children:[e.jsx("div",{className:"col-span-2 grid gap-y-2",children:j&&Object.keys(r).length>0&&e.jsx(e.Fragment,{children:Object.entries(r).map(([a,n])=>e.jsx(C,{severity:"warn",text:n},a))})}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"font-bold mb-2 block",children:"Müşteri Tipi"}),e.jsx(h,{value:s.type,onChange:a=>p("type",a.value),options:w,itemTemplate:a=>e.jsxs(f.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex items-center gap-2 px-4 py-2",children:[e.jsx("i",{className:a.icon}),e.jsx("span",{children:a.label})]}),className:"w-full"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{htmlFor:"name",className:"font-bold",children:[u?"Firma Adı":"Müşteri Adı"," ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(o,{id:"name",name:"name",onChange:m,value:s.name||"",autoFocus:!0})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold",children:["E-posta Adresi ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(o,{id:"email",type:"email",name:"email",onChange:m,value:s.email||""})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"phone",className:"font-bold",children:["Telefon Numarası ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(T,{id:"phone",name:"phone",value:s.phone,onChange:m,mask:"(999) 999-9999",placeholder:"(5XX) XXX-XXXX",className:r.phone?"p-invalid w-full":"w-full"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"address",className:"font-bold",children:["Adres ",e.jsx("span",{className:"font-semibold text-red-400",children:"*"})]}),e.jsx(o,{id:"address",type:"text",name:"address",onChange:m,value:s.address||""})]}),u&&e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"vatName",className:"font-bold block mb-2",children:["Vergi Adı",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"vatName",value:s.vatName,onChange:m,className:r.vatName?"p-invalid w-full":"w-full"}),r.vatName&&e.jsx("small",{className:"p-error",children:r.vatName})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"vatNumber",className:"font-bold block mb-2",children:["Vergi Numarası",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"vatNumber",value:s.vatNumber,onChange:m,className:r.vatNumber?"p-invalid w-full":"w-full"}),r.vatNumber&&e.jsx("small",{className:"p-error",children:r.vatNumber})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"vatOffice",className:"font-bold block mb-2",children:["Vergi Dairesi",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"vatOffice",value:s.vatOffice,onChange:m,className:r.vatOffice?"p-invalid w-full":"w-full"}),r.vatOffice&&e.jsx("small",{className:"p-error",children:r.vatOffice})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"player_id",className:"font-bold",children:"Device ID"}),e.jsx(o,{id:"player_id",type:"text",name:"player_id",onChange:m,value:s.player_id||""})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"font-bold block mb-2",children:"İletişim Tercihleri"}),e.jsx(h,{multiple:!0,value:s.contact,onChange:a=>p("contact",a.value),itemTemplate:a=>{let n=s.contact&&s.contact.includes(a.value);return e.jsx("div",{className:"w-full text-center",children:e.jsx("i",{className:a.icon+" p-overlay-badge",style:{fontSize:"1.5rem"},children:n&&e.jsx(z,{severity:"success",value:e.jsx("i",{className:"pi pi-check"}),style:{fontSize:"1px"}})})})},optionLabel:"value",options:[{icon:"pi pi-envelope",value:"email"},{icon:"pi pi-send",value:"sms"},{icon:"pi pi-bell",value:"push"}]})]}),e.jsx("button",{type:"submit",style:{display:"none"},ref:N})]})})}export{G as default};
