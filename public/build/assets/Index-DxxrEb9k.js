import{r as i,F as K,j as e,L as A,S as _}from"./app-DZRt12gr.js";import{A as M}from"./AuthenticatedLayout-DSu8RXeD.js";import{D as Y}from"./datatable.esm-CFURs1qP.js";import{C as l}from"./column.esm-BOowLkgO.js";import{I as V}from"./inputtext.esm-D01KRESy.js";import{B as o}from"./button.esm-YpR-gUOh.js";import{T as W}from"./tooltip.esm-DS_YqtbC.js";import{C as X,c as N}from"./confirmpopup.esm-DBdZj4A5.js";import{T as q}from"./toolbar.esm-CZCuE4py.js";import{T as J}from"./toast.esm-B_ekDU8w.js";import{O as u}from"./overlaypanel.esm-oubLM7D0.js";import{C as Q}from"./checkbox.esm-Cp6zxhc5.js";import{c as U}from"./ripple.esm-DhWGB1f6.js";import{T as Z}from"./tag.esm-B6bffCSt.js";import{C as $}from"./CarBody-CtfwYeY_.js";import"./Dropdown-D_5RIROw.js";import"./motion-B0DhcIWL.js";import"./index.esm-BAT9upmF.js";import"./paginator.esm-CO5cdxva.js";import"./inputnumber.esm-DxIztzAQ.js";import"./index.esm-BUnoTeS2.js";import"./dropdown.esm-DwgTzAS8.js";import"./index.esm-BhJDJnrD.js";import"./index.esm-Cwzze1wr.js";import"./overlayservice.esm-CS3FeIVU.js";import"./csstransition.esm-Cgnjg-zy.js";import"./index.esm-2ic6gNnP.js";import"./index.esm-CMPnDEQL.js";import"./index.esm-DO5I4nK9.js";import"./index.esm-CwAQJBOA.js";import"./index.esm-Cp27H1Q_.js";import"./index.esm-BVXiDbbQ.js";import"./index.esm-PfAdUoYd.js";import"./TransitionGroup-BCL1N9Mq.js";import"./index.esm-CBw_58NG.js";import"./scrollpanel.esm-BWy2_gLQ.js";function Be({auth:T,servicesAll:z,csrf_token:h,page:f=!0,dealerPage:j=!1}){const[S,d]=i.useState(!1),c=i.useRef(null),p=i.useRef(null),g=i.useRef(null),y=i.useRef(null);i.useState(!1);const[b,F]=i.useState({global:{value:null,matchMode:K.CONTAINS}}),[k,L]=i.useState(""),[H,O]=i.useState(z),E=["id","service_no","customer_name","worker_name","warranty","status","car","updated_at","created_at","actions","note"],P={id:"ID",service_no:"Hizmet Numarası",customer_name:"Müşteri Adı",worker_name:"Ekleyen Çalışan",warranty:"Garanti Bilgileri",status:"Durumu",car:"Araç",updated_at:"Güncellenme Tarihi",created_at:"Eklenme Tarihi",actions:"İşlemler",note:"Not"},R=f===!0?"worker-services-table-columns":"worker-services-table-columns-2",[a,B]=U(["id","service_no","customer_name","worker_name","status","car","created_at","actions"],R),v=(t,r=!1)=>{const s=r?t:t.target.value;let m={...b};m.global.value=s,F(m),L(s)},G=e.jsx(e.Fragment,{children:e.jsx(q,{start:()=>e.jsxs(e.Fragment,{children:[j===!1&&e.jsx(o,{icon:"pi pi-plus",size:"small",severity:"success",tooltip:"Yeni Hizmet Ekle",tooltipOptions:{position:"top"},onClick:()=>{_.visit(route("worker.services.create"))},className:"mr-2"}),e.jsx(o,{icon:"pi pi-bars",size:"small",severity:"info",tooltip:"Kolonları Yönet",tooltipOptions:{position:"top"},onClick:t=>{p.current.toggle(t)},className:"mr-2"})]}),end:()=>e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"p-input-icon-left",children:[e.jsx("i",{className:"pi pi-search"}),e.jsx(V,{size:"small",value:k,onChange:v,placeholder:"Hizmetlerde Arama Yapın"})]}),k!==""&&e.jsx(o,{size:"small",icon:"pi pi-times",className:"p-button-info ml-2",onClick:()=>v("",!0),tooltip:"Filtreyi Temizle",tooltipOptions:{position:"top"}})]})})}),[n,x]=i.useState(null),I=(t,r)=>{N({target:t.currentTarget,message:"Garanti başlatmak istediğinize emin misiniz?",icon:"pi pi-exclamation-triangle",acceptClassName:"p-button-success",acceptLabel:"Evet",rejectLabel:"Hayır",accept:()=>{fetch(route("worker.services.startWarranty",r.service_no),{method:"POST",headers:{"X-CSRF-TOKEN":h}}).then(s=>s.json()).then(s=>{s.status?(c.current.show({severity:"success",summary:"Başarılı",detail:s.message}),O(s.services)):c.current.show({severity:"error",summary:"Hata",detail:s.message})}).catch(s=>{c.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{d(!1)})}})},w=i.useRef(null),C=()=>e.jsxs(e.Fragment,{children:[e.jsx(W,{target:".custom-target-icon"}),e.jsx(X,{}),e.jsx(J,{ref:c}),e.jsx(u,{ref:p,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h3",{children:"Kolonları Yönet"})}),e.jsxs("div",{className:"flex flex-col",children:[E.map((t,r)=>e.jsxs("div",{className:"flex my-1 items-center",children:[e.jsx(Q,{inputId:t,checked:a.includes(t),onChange:s=>{let m=[...a];s.checked?m.push(t):m=m.filter(D=>D!==t),B(m)}}),e.jsx("label",{htmlFor:t,className:"ml-2",children:P[t]})]},r)),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(o,{label:"Kaydet",severity:"success",size:"small",onClick:()=>{p.current.hide()}})})]})]})}),e.jsx(u,{ref:w,showCloseIcon:!0,closeOnEscape:!0,children:e.jsx("p",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:n==null?void 0:n.note}})})}),e.jsx(u,{ref:g,showCloseIcon:!0,closeOnEscape:!0,children:n&&n.status==="completed"&&e.jsx(e.Fragment,{children:e.jsx("ul",{children:n.warranty.map((t,r)=>e.jsxs("li",{children:[t.name," - ",t.label]}))})})}),e.jsx(u,{ref:y,showCloseIcon:!0,closeOnEscape:!0,children:e.jsx($,{editable:!1,value:n==null?void 0:n.body,onChange:()=>{}})}),e.jsxs(Y,{value:H,removableSort:!0,paginator:!0,paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink",rowsPerPageOptions:[5,10,25,50],rows:10,dataKey:"id",filters:b,loading:S,globalFilterFields:["service_no","worker_name","car","customer_name","status"],header:G,emptyMessage:"Hizmet bulunamadı.",currentPageReportTemplate:"{first}. ile {last}. arası toplam {totalRecords} kayıttan",children:[a.includes("id")&&e.jsx(l,{field:"id",sortable:!0,header:"#"}),a.includes("service_no")&&e.jsx(l,{field:"service_no",sortable:!0,header:"Hizmet Numarası",body:({service_no:t})=>e.jsx(o,{label:t,link:!0,onClick:()=>{window.open(route("warranty.index",t),"_blank")}})}),a.includes("customer_name")&&e.jsx(l,{field:"customer.name",sortable:!0,header:"Müşteri Adı"}),a.includes("worker_name")&&e.jsx(l,{field:"worker.name",sortable:!0,header:"Ekleyen Çalışan"}),a.includes("warranty")&&e.jsx(l,{field:"warranty_x",align:"center",header:"Garanti Bilgileri",body:t=>e.jsx("div",{children:t.status==="completed"&&e.jsx(o,{icon:"pi pi-calendar",onClick:r=>{x(t),g.current.toggle(r)},tooltip:"Garanti Bilgileri",severity:"success"})})}),a.includes("status")&&e.jsx(l,{field:"status",sortable:!0,header:"Durumu",body:({status_label:t,status_severity:r})=>e.jsx(Z,{value:t,severity:r})}),a.includes("car")&&e.jsx(l,{field:"car.brand",sortable:!0,header:"Araç",body:t=>e.jsx(o,{label:t.car.brand+"-"+t.car.model,size:"small",link:!0,onClick:r=>{x(t),y.current.toggle(r)}})}),a.includes("note")&&e.jsx(l,{field:"note",sortable:!0,header:"Hizmet Notu",body:t=>e.jsx(o,{label:"Notu Görüntüle",size:"small",link:!0,onClick:r=>{x(t),w.current.toggle(r)}})}),a.includes("created_at")&&e.jsx(l,{field:"created_at",sortable:!0,header:"Eklenme Tarihi",body:t=>new Date(t.created_at).toLocaleString()}),a.includes("updated_at")&&e.jsx(l,{field:"updated_at",sortable:!0,header:"Güncellenme Tarihi",body:t=>new Date(t.updated_at).toLocaleString()}),a.includes("actions")&&j===!1&&e.jsx(l,{header:"İşlemler",body:t=>e.jsxs("div",{className:"flex justify-center gap-x-2",children:[(t==null?void 0:t.status)==="progress"&&e.jsx(o,{icon:"pi pi-calendar-clock",size:"small",tooltip:"Garanti Başlat",tooltipOptions:{position:"top"},severity:"success",onClick:r=>I(r,t)}),e.jsx(o,{icon:"pi pi-trash",size:"small",tooltip:"Hizmet Kaydını Sil",tooltipOptions:{position:"top"},severity:"danger",onClick:r=>{N({target:r.currentTarget,message:"Bu işlemi gerçekleştirmek istediğinize emin misiniz?",icon:"pi pi-info-circle",defaultFocus:"reject",acceptClassName:"p-button-danger",accept:()=>{d(!0),fetch(route("worker.services.destroy",t.id),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":h}}).then(s=>s.json()).then(s=>{s.status?(c.current.show({severity:"success",summary:"Başarılı",detail:s.message}),_.reload()):c.current.show({severity:"error",summary:"Hata",detail:s.message})}).catch(s=>{console.log(s),c.current.show({severity:"error",summary:"Hata",detail:"CSRF Token Hatası Lütfen Sayfayı Yenileyiniz.."})}).finally(()=>{d(!1)})},acceptLabel:"Sil",rejectLabel:"Vazgeç"})}})]})})]})]});return f===!0?e.jsxs(M,{user:T.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Hizmet Kayıtları"}),children:[e.jsx(A,{title:"Hizmet Kayıtları"}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx(C,{})})})})]}):e.jsx(C,{})}export{Be as default};
