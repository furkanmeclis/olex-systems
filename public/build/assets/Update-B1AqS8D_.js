import{r as m,j as e}from"./app-DFN-SBn_.js";import{I as o}from"./inputtext.esm-B6ApckKV.js";import{B as f}from"./button.esm-DUV2jUL6.js";import{B as w}from"./blockui.esm-BitQipqg.js";import{u as C}from"./formik.esm-Dus8OX-h.js";import{c as k,a as i}from"./index.esm-DhfmEgF2.js";import{S as v}from"./selectbutton.esm-BUwfH9-Q.js";import{T}from"./toast.esm-DNfx21sM.js";import{D as F}from"./dialog.esm-CJSXAS6-.js";import{I as O}from"./inputmask.esm-CBmrk8F1.js";import{m as h}from"./motion-DQFm0ftV.js";import"./ripple.esm-kMaAI51K.js";import"./tooltip.esm-DfPOOgxk.js";import"./index.esm-CMHdvxuc.js";import"./_baseClone-BgPU1wOP.js";import"./csstransition.esm-BJa-8sZm.js";import"./index.esm-Ci16NstO.js";import"./index.esm-YOiNYMyb.js";import"./index.esm-DW3vfaFK.js";import"./index.esm-DiUbI_mW.js";import"./TransitionGroup-B0ffCrpz.js";const S=k().shape({type:i().required("Müşteri tipi seçimi zorunludur"),name:i().required("Müşteri/Firma Adı zorunludur"),email:i().email("Geçerli bir e-posta adresi giriniz").required("E-posta adresi zorunludur"),phone:i().required("Telefon numarası zorunludur"),address:i().required("Adres zorunludur"),vatName:i().when("type",{is:"company",then:()=>i().required("Vergi adı zorunludur"),otherwise:()=>i()}),vatNumber:i().when("type",{is:"company",then:()=>i().required("Vergi numarası zorunludur"),otherwise:()=>i()}),vatOffice:i().when("type",{is:"company",then:()=>i().required("Vergi dairesi zorunludur"),otherwise:()=>i()})});function W({csrf_token:x,setUsers:N,user:s,visible:b,setVisible:c}){const n=m.useRef(null),[d,p]=m.useState(!1),j=m.useMemo(()=>s!=null&&s.notification_settings?Object.entries(JSON.parse(s.notification_settings)).map(([l,t])=>t?l:null).filter(l=>l!==null):[],[s]),a=C({initialValues:{type:s.type||"individual",name:s.name||"",email:s.email||"",phone:s.phone||"",address:s.address||"",player_id:s.player_id||"",contact:j,vatName:s.vat_name||"",vatNumber:s.vat_number||"",vatOffice:s.vat_office||""},validationSchema:S,onSubmit:l=>{p(!0);let t=new FormData;Object.keys(l).forEach(r=>{r==="contact"?t.append("notification_settings",JSON.stringify(l[r])):t.append(r,l[r])}),t.append("_method","PUT"),fetch(route("worker.customers.update",s.id),{method:"POST",headers:{"X-CSRF-TOKEN":x},body:t}).then(r=>r.json()).then(r=>{r.status?(n.current.show({severity:"success",summary:"Başarılı",detail:r.message}),setTimeout(()=>{N(r.customers),c(!1)},500)):n.current.show({severity:"error",summary:"Hata",detail:r.message})}).catch(()=>{n.current.show({severity:"error",summary:"Hata",detail:"Bir hata oluştu"})}).finally(()=>{p(!1)})}}),u=m.useMemo(()=>a.values.type==="company",[a.values.type]),g=[{icon:"pi pi-user",value:"individual",label:"Bireysel"},{icon:"pi pi-building",value:"company",label:"Kurumsal"}],y=[{icon:"pi pi-envelope",value:"email",label:"E-posta"},{icon:"pi pi-send",value:"sms",label:"SMS"},{icon:"pi pi-bell",value:"push",label:"Bildirim"}];return e.jsxs(e.Fragment,{children:[e.jsx(T,{ref:n}),e.jsx(F,{header:`${u?"Kurumsal":"Bireysel"} Müşteri Düzenle`,visible:b,style:{width:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"},onHide:()=>c(!1),maximizable:!0,footer:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(f,{label:"Vazgeç",icon:"pi pi-times",onClick:()=>c(!1),className:"p-button-text",disabled:d}),e.jsx(f,{label:"Kaydet",icon:"pi pi-check",onClick:a.handleSubmit,loading:d})]}),children:e.jsx(w,{blocked:d,children:e.jsx("form",{onSubmit:a.handleSubmit,className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{className:"font-bold mb-2 block",children:"Müşteri Tipi"}),e.jsx(v,{value:a.values.type,onChange:l=>a.setFieldValue("type",l.value),options:g,itemTemplate:l=>e.jsxs(h.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex items-center gap-2 px-4 py-2",children:[e.jsx("i",{className:l.icon}),e.jsx("span",{children:l.label})]}),className:"w-full"})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"name",className:"font-bold block mb-2",children:[u?"Firma Adı":"Müşteri Adı",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"name",value:a.values.name,onChange:a.handleChange,className:a.errors.name&&a.touched.name?"p-invalid w-full":"w-full"}),a.errors.name&&a.touched.name&&e.jsx("small",{className:"p-error",children:a.errors.name})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"email",className:"font-bold block mb-2",children:["E-posta Adresi",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"email",value:a.values.email,onChange:a.handleChange,className:a.errors.email&&a.touched.email?"p-invalid w-full":"w-full"}),a.errors.email&&a.touched.email&&e.jsx("small",{className:"p-error",children:a.errors.email})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"phone",className:"font-bold block mb-2",children:["Telefon Numarası",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(O,{id:"phone",value:a.values.phone,onChange:a.handleChange,mask:"(999) 999-9999",placeholder:"(5XX) XXX-XXXX",className:a.errors.phone&&a.touched.phone?"p-invalid w-full":"w-full"}),a.errors.phone&&a.touched.phone&&e.jsx("small",{className:"p-error",children:a.errors.phone})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"address",className:"font-bold block mb-2",children:["Adres",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"address",value:a.values.address,onChange:a.handleChange,className:a.errors.address&&a.touched.address?"p-invalid w-full":"w-full"}),a.errors.address&&a.touched.address&&e.jsx("small",{className:"p-error",children:a.errors.address})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"player_id",className:"font-bold block mb-2",children:"Device ID"}),e.jsx(o,{id:"player_id",value:a.values.player_id,onChange:a.handleChange,className:"w-full"})]}),u&&e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"vatName",className:"font-bold block mb-2",children:["Vergi Adı",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"vatName",value:a.values.vatName,onChange:a.handleChange,className:a.errors.vatName&&a.touched.vatName?"p-invalid w-full":"w-full"}),a.errors.vatName&&a.touched.vatName&&e.jsx("small",{className:"p-error",children:a.errors.vatName})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"vatNumber",className:"font-bold block mb-2",children:["Vergi Numarası",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"vatNumber",value:a.values.vatNumber,onChange:a.handleChange,className:a.errors.vatNumber&&a.touched.vatNumber?"p-invalid w-full":"w-full"}),a.errors.vatNumber&&a.touched.vatNumber&&e.jsx("small",{className:"p-error",children:a.errors.vatNumber})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"vatOffice",className:"font-bold block mb-2",children:["Vergi Dairesi",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{id:"vatOffice",value:a.values.vatOffice,onChange:a.handleChange,className:a.errors.vatOffice&&a.touched.vatOffice?"p-invalid w-full":"w-full"}),a.errors.vatOffice&&a.touched.vatOffice&&e.jsx("small",{className:"p-error",children:a.errors.vatOffice})]})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{className:"font-bold block mb-2",children:"İletişim Tercihleri"}),e.jsx(v,{multiple:!0,value:a.values.contact,onChange:l=>a.setFieldValue("contact",l.value),options:y,itemTemplate:l=>{var r;const t=(r=a.values.contact)==null?void 0:r.includes(l.value);return e.jsxs(h.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex items-center gap-2 px-4 py-2",children:[e.jsx("i",{className:`${l.icon} ${t?"text-primary":""}`}),e.jsx("span",{children:l.label})]})},className:"w-full"})]})]})})})})]})}export{W as default};
